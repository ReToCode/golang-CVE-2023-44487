package main

import (
	"crypto/tls"
	"log"
	"net/http"
	"net/http/httputil"
)

func main() {
	tr := &http.Transport{
		TLSClientConfig: &tls.Config{InsecureSkipVerify: true},
	}

	revProxy := httputil.ReverseProxy{
		Director: func(req *http.Request) {
			req.URL.Scheme = "https"
			req.URL.Host = "localhost:8444"
		},
		Transport: tr,
	}
	srv := &http.Server{
		Addr:    ":8443",
		Handler: &revProxy,
	}

	log.Printf("Serving on https://0.0.0.0:8443")
	log.Fatal(srv.ListenAndServeTLS("certs/server.crt", "certs/server.key"))
}
